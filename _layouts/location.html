---
layout: default
---

<div class="mt-5">
    <h1 id="location">{{ page.name }}</h1>
</div>
<div class="container row mt-2">
    <p><i class="bi bi-geo-alt"></i> </p>
    <!-- Important to use api_name as JavaScript uses this as a variable to access API -->
    <p id=api_name>{{ page.api_name }}</p>
</div>
<hr>

<div class="container mt-5">
    <ol id="machines">

    </ol>

    <table class="table" id="machineList">
        <thead>
            <tr>
                <th>#</th>
                <th>Machine</th>
                <th>Machine Type</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
</div>

<script type="text/javascript" charset="utf-8">
    document.addEventListener('DOMContentLoaded', () => {
        var location = document.getElementById("api_name");
        var locationName = location.textContent;
        // console.log(name);

        let parser = new DOMParser();
		let request = new XMLHttpRequest();
		request.open("GET", "https://www.soledigital.com.au/accesspack/UWS_data.asp");
		request.send();
		request.onload = () => {
			// console.log(request.response);
			xmlDoc = parser.parseFromString(request.response, "text/xml")
			if (request.status != 200) {
				console.log(`error ${request.status} ${request.statusText}`)
			}
            // Reading the root of XML
            let institute = xmlDoc.getElementsByTagName("site")[0];

            // All the locations (e.g. Kingswood, PEIH)
            let locations = institute.getElementsByTagName("site");

            // iterating over the locations
            for (let i = 0; i < locations.length; i++){
                let siteName = locations[i].getElementsByTagName("name")[0].firstChild.nodeValue;

                // Checking if the site name is the same as the page (i.e. Only machines from Kingswood campus for Kingswood page)
                if (siteName == locationName) {
                    // root of the equipment for a location (site)
                    let equipment = locations[i].getElementsByTagName("equipment")[0];

                    // Extracting all the equipment Id
                    let equipmentId = equipment.getElementsByTagName("equipid");

                    // Extracting all the equipment type
                    let equipmentType = equipment.getElementsByTagName("equiptype");

                    // iterating over the equipment
                    for (let j = 0; j < equipmentId.length; j++){
                        let eqId = equipmentId[j].firstChild.nodeValue;
                        let eqType = equipmentType[j].firstChild.nodeValue;

                        // Creating a table
                        let table = document.getElementById("machineList");

                        // Adds a row at the bottom
                        let row = table.insertRow(-1);

                        // Creating respective cells
                        let serialNumber = row.insertCell(0);
                        let machineName = row.insertCell(1);
                        let machineType = row.insertCell(2);

                        // Adding values to the table cells
                        serialNumber.innerHTML = j+1;
                        machineName.innerHTML = eqId;
                        machineType.innerHTML = eqType;
                    }
                }
            }
		}
    });
</script>
